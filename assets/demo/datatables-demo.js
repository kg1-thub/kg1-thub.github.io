// Call the dataTables jQuery plugin
$(document).ready(function() {
  $('#dataTable18').DataTable({
    order: [ [ 1, "desc" ] ],
    "columnDefs": [
      { "width": "8%", "targets": 2 },
      { "width": "8%", "targets": 3 },
      { "width": "8%", "targets": 4 },
      { "width": "8%", "targets": 5 },
      { "width": "8%", "targets": 6 },
      { "width": "8%", "targets": 8 },
      { "width": "8%", "targets": 9 },
      { "width": "8%", "targets": 10 }
    ],
    "searching": false,
    "paging": false,
    "info": false,
    // scrollX: true,
    // scrollCollapse: true,
    // fixedColumns: true
  });
});

$(document).ready(function() {
  $('#dataTable19').DataTable({
    order: [ [ 1, "desc" ] ],
    "columnDefs": [
      { "width": "8%", "targets": 2 },
      { "width": "8%", "targets": 3 },
      { "width": "8%", "targets": 4 },
      { "width": "8%", "targets": 5 },
      { "width": "8%", "targets": 6 },
      { "width": "8%", "targets": 8 },
      { "width": "8%", "targets": 9 },
      { "width": "8%", "targets": 10 }
    ],
    "searching": false,
    "paging": false,
    "info": false,
    // scrollX: true,
    // scrollCollapse: true,
    // fixedColumns: true
  });
});

$(document).ready(function() {
  $('#dataTable19v2').DataTable({
    order: [ [ 0, "asc" ] ],
    "columnDefs": [
      { "width": "17%", "targets": 1 },
      { "width": "17%", "targets": 2 },
      { "width": "17%", "targets": 3 },
      { "width": "11%", "targets": 4 },
      { "width": "11%", "targets": 5 },
      { "width": "11%", "targets": 6 },
      { "width": "11%", "targets": 7 },
    ],
    "searching": false,
    "paging": false,
    "info": false
  });
});

$(document).ready(function() {
  $('#dataTable19v3').DataTable({
    order: [ [ 1, "desc" ] ],
    "columnDefs": [
      { "width": "17%", "targets": 1 },
      { "width": "17%", "targets": 2 },
      { "width": "17%", "targets": 3 },
      { "width": "11%", "targets": 4 },
      { "width": "11%", "targets": 5 },
      { "width": "11%", "targets": 6 },
      { "width": "11%", "targets": 7 },
    ],
    "searching": false,
    "paging": false,
    "info": false
  });
});

$(document).ready(function() {
  $('#dataTable20').DataTable({
    order: [ [ 1, "desc" ] ],
    "columnDefs": [
      { "width": "8%", "targets": 2 },
      { "width": "8%", "targets": 3 },
      { "width": "8%", "targets": 4 },
      { "width": "8%", "targets": 5 },
      { "width": "8%", "targets": 6 },
      { "width": "8%", "targets": 7 },
      { "width": "8%", "targets": 9 },
      { "width": "8%", "targets": 10 },
      { "width": "8%", "targets": 11 }
    ],
    "searching": false,
    "paging": false,
    "info": false
  });
});

$(document).ready(function() {
  $('#dataTable20v2').DataTable({
    order: [ [ 0, "asc" ] ],
    "columnDefs": [
      // { "width": "17%", "targets": 1 },
      // { "width": "17%", "targets": 2 },
      // { "width": "17%", "targets": 3 },
      // { "width": "11%", "targets": 4 },
    ],
    "searching": false,
    "paging": false,
    "info": false
  });
});

$(document).ready(function() {
  $('#dataTable20v3').DataTable({
    order: [ [ 1, "desc" ], [ 2, "desc" ], [ 3, "desc" ]],
    "columnDefs": [
      { "width": "22%", "targets": 1 },
      { "width": "22%", "targets": 2 },
      { "width": "22%", "targets": 3 },
      { "width": "22%", "targets": 4 },
    ],
    "searching": false,
    "paging": false,
    "info": false
  });
});

$(document).ready(function() {
  $('#dataTable21').DataTable({
    order: [ [ 1, "desc" ] ],
    "columnDefs": [
      { "width": "8%", "targets": 2 },
      { "width": "8%", "targets": 3 },
      { "width": "8%", "targets": 4 },
      { "width": "8%", "targets": 5 },
      { "width": "8%", "targets": 6 },
      { "width": "8%", "targets": 7 },
      { "width": "8%", "targets": 9 },
      { "width": "8%", "targets": 10 },
      { "width": "8%", "targets": 11 }
    ],
    "searching": false,
    "paging": false,
    "info": false
  });
});

$(document).ready(function() {
  $('#dataTable21v2').DataTable({
    order: [ [ 0, "asc" ] ],
    "columnDefs": [
      // { "width": "17%", "targets": 1 },
      // { "width": "17%", "targets": 2 },
      // { "width": "17%", "targets": 3 },
      // { "width": "11%", "targets": 4 },
    ],
    "searching": false,
    "paging": false,
    "info": false
  });
});

$(document).ready(function() {
  $('#dataTable21v3').DataTable({
    order: [ [ 3, "desc" ], [ 1, "desc" ], [ 2, "desc" ]],
    "columnDefs": [
      { "width": "22%", "targets": 1 },
      { "width": "22%", "targets": 2 },
      { "width": "22%", "targets": 3 },
      { "width": "22%", "targets": 4 },
    ],
    "searching": false,
    "paging": false,
    "info": false
  });
});

$(document).ready(function() {
  $('#dataTable22').DataTable({
    order: [ [ 1, "desc" ] ],
    "columnDefs": [
      { "width": "8%", "targets": 2 },
      { "width": "8%", "targets": 3 },
      { "width": "8%", "targets": 4 },
      { "width": "8%", "targets": 5 },
      { "width": "8%", "targets": 6 },
      { "width": "8%", "targets": 7 },
      { "width": "8%", "targets": 9 },
      { "width": "8%", "targets": 10 },
      { "width": "8%", "targets": 11 }
    ],
    "searching": false,
    "paging": false,
    "info": false
  });
});

$(document).ready(function() {
  $('#dataTable22v2').DataTable({
    order: [ [ 0, "asc" ] ],
    "columnDefs": [
      // { "width": "17%", "targets": 1 },
      // { "width": "17%", "targets": 2 },
      // { "width": "17%", "targets": 3 },
      // { "width": "11%", "targets": 4 },
    ],
    "searching": false,
    "paging": false,
    "info": false
  });
});

$(document).ready(function() {
  $('#dataTable22v3').DataTable({
    // order: [ [ 3, "desc" ], [ 1, "desc" ], [ 2, "desc" ]],
    order: [[ 1, "desc" ]],
    "columnDefs": [
      { "width": "22%", "targets": 1 },
      { "width": "22%", "targets": 2 },
      { "width": "22%", "targets": 3 },
      { "width": "22%", "targets": 4 },
    ],
    "searching": false,
    "paging": false,
    "info": false
  });
});

// dataTable22days
function makeCSV(records, columns) {
  const divtable = document.getElementById('dataTable22days');
  const divthead = document.createElement("thead");
  divtable.appendChild(divthead);
  const divtheadr = document.createElement("tr");
  divthead.appendChild(divtheadr);
  let divth = document.createElement("th");
  divth.textContent = 'seq';
  divtheadr.appendChild(divth);
  for (var j = 0; j < columns.length; j++) {
      let divth = document.createElement("th");
      divth.textContent = columns[j];
      divtheadr.appendChild(divth);
  }

  const divtbody = document.createElement("tbody");
  divtable.appendChild(divtbody);
  for (var i = 0; i < records.length; i++) {
      let divtr = document.createElement("tr");
      divtbody.appendChild(divtr);
      let divtd = document.createElement("td");
      divtd.textContent = String(i);
      divtr.appendChild(divtd);
      for (var j = 0; j < columns.length; j++) {
          let divtd = document.createElement("td");
          divtd.textContent = records[i][j];
          divtr.appendChild(divtd);
      }
  }

  $(document).ready(function() {
      $('#dataTable22days').DataTable({
        order: [[ 0, "asc" ]],
          "columnDefs": [
            { "visible": false, "targets": 0 },
            { "visible": false, "targets": 4 },
            { "visible": false, "targets": 5 },
            { "visible": false, "targets": 6 },
            { "visible": false, "targets": 7 },
            { "visible": false, "targets": 14 },
          ],
          "searching": true,
          "search": {
            "regex": true
          },
          "paging": true,
          "info": true,
          // "language": {
          //   "searchPlaceholder": "2022/05/*"
          // }
          // lengthMenu: [ 5, 10, 15, 20, 50 ]
      });
  });
};

{
  var fileurl = "https://raw.githubusercontent.com/kg1-thub/kg1-thub.github.io/master/assets/data/csv/catcher_stats22.csv";
  fetch(fileurl)
  .then(res => res.blob()) // Gets the response and returns it as a blob
  .then(blob => {
      var file = blob;
      var reader = new FileReader();
      reader.readAsText(file, 'Shift_JIS');
      reader.onload = function(event) {
          var textdata = event.target.result;
          var tmp = textdata.split("\n");
          var cols = tmp[0].split(",");
          var records = [];
          for (var i = 0; i < tmp.length-2; i++) {
              var row_data = tmp[i+1];
              records[i] = row_data.split(",");
          }
          makeCSV(records, cols);
      };
      reader.onerror = function() {
          alert("エラー：ファイルをロードできません。");
      };
  });
}
